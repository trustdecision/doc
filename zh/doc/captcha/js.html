<!DOCTYPE html>
<html lang="简体中文">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>集成前端 JS | trustdevice</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/td/logo/icon.png">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4430f3f32f20bc88a8d30fe02df17081";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s); })();
            </script>
    <meta name="description" content="">
    <meta name="google-site-verification" content="NSp25_zH--p8r461f1YcEUt0LX9s7oRnyP3iBTvANIQ">
    <meta name="baidu-site-verification" content="codeva-A2SMJcZcws">
    
    <link rel="preload" href="/td/assets/css/0.styles.a099e45a.css" as="style"><link rel="preload" href="/td/assets/js/app.185a84cc.js" as="script"><link rel="preload" href="/td/assets/js/2.2e3d5896.js" as="script"><link rel="preload" href="/td/assets/js/52.39a8f530.js" as="script"><link rel="prefetch" href="/td/assets/js/10.d1a0450d.js"><link rel="prefetch" href="/td/assets/js/11.20c64dab.js"><link rel="prefetch" href="/td/assets/js/12.3d8ad0f6.js"><link rel="prefetch" href="/td/assets/js/13.97bdc425.js"><link rel="prefetch" href="/td/assets/js/14.ffcd274e.js"><link rel="prefetch" href="/td/assets/js/15.276ed812.js"><link rel="prefetch" href="/td/assets/js/16.e2de7c8c.js"><link rel="prefetch" href="/td/assets/js/17.77d1d906.js"><link rel="prefetch" href="/td/assets/js/18.b7c44b45.js"><link rel="prefetch" href="/td/assets/js/19.f3fdc9fc.js"><link rel="prefetch" href="/td/assets/js/20.4ce2f16d.js"><link rel="prefetch" href="/td/assets/js/21.9106a342.js"><link rel="prefetch" href="/td/assets/js/22.8de5b04e.js"><link rel="prefetch" href="/td/assets/js/23.75f67d14.js"><link rel="prefetch" href="/td/assets/js/24.7c417886.js"><link rel="prefetch" href="/td/assets/js/25.7ced5130.js"><link rel="prefetch" href="/td/assets/js/26.4e29552d.js"><link rel="prefetch" href="/td/assets/js/27.c528b1c4.js"><link rel="prefetch" href="/td/assets/js/28.1858c5da.js"><link rel="prefetch" href="/td/assets/js/29.bf9bfb41.js"><link rel="prefetch" href="/td/assets/js/3.2158ca86.js"><link rel="prefetch" href="/td/assets/js/30.e127d219.js"><link rel="prefetch" href="/td/assets/js/31.af9c2105.js"><link rel="prefetch" href="/td/assets/js/32.b89c8ceb.js"><link rel="prefetch" href="/td/assets/js/33.110a9675.js"><link rel="prefetch" href="/td/assets/js/34.2ef87457.js"><link rel="prefetch" href="/td/assets/js/35.35d7147e.js"><link rel="prefetch" href="/td/assets/js/36.4f7e50ed.js"><link rel="prefetch" href="/td/assets/js/37.65bebbe2.js"><link rel="prefetch" href="/td/assets/js/38.a12717c4.js"><link rel="prefetch" href="/td/assets/js/39.4d2a5484.js"><link rel="prefetch" href="/td/assets/js/4.2885e313.js"><link rel="prefetch" href="/td/assets/js/40.e61eb3cb.js"><link rel="prefetch" href="/td/assets/js/41.b36c9bc6.js"><link rel="prefetch" href="/td/assets/js/42.6923d430.js"><link rel="prefetch" href="/td/assets/js/43.c0676a63.js"><link rel="prefetch" href="/td/assets/js/44.a4deda5e.js"><link rel="prefetch" href="/td/assets/js/45.f7fa5a91.js"><link rel="prefetch" href="/td/assets/js/46.eb23c720.js"><link rel="prefetch" href="/td/assets/js/47.21918068.js"><link rel="prefetch" href="/td/assets/js/48.6944f99d.js"><link rel="prefetch" href="/td/assets/js/49.0e78f848.js"><link rel="prefetch" href="/td/assets/js/5.102392b0.js"><link rel="prefetch" href="/td/assets/js/50.923f3a0a.js"><link rel="prefetch" href="/td/assets/js/51.502adbfd.js"><link rel="prefetch" href="/td/assets/js/53.86260b02.js"><link rel="prefetch" href="/td/assets/js/54.4536f93c.js"><link rel="prefetch" href="/td/assets/js/55.0dc4fe6a.js"><link rel="prefetch" href="/td/assets/js/56.f97e27e3.js"><link rel="prefetch" href="/td/assets/js/57.8476743f.js"><link rel="prefetch" href="/td/assets/js/58.93c9de17.js"><link rel="prefetch" href="/td/assets/js/59.0bea9c2e.js"><link rel="prefetch" href="/td/assets/js/6.ea70f831.js"><link rel="prefetch" href="/td/assets/js/7.3611bbe9.js"><link rel="prefetch" href="/td/assets/js/8.8fde20e2.js"><link rel="prefetch" href="/td/assets/js/9.29164caf.js">
    <link rel="stylesheet" href="/td/assets/css/0.styles.a099e45a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/td/zh/" class="home-link router-link-active"><img src="/td/logo/icon.png" alt="trustdevice" class="logo"> <span class="site-name can-hide">trustdevice</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/captcha/js.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/captcha/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/captcha/js.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/captcha/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/" aria-current="page" class="sidebar-link">总览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>设备指纹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/fingerprint/android.html" class="sidebar-link">Android</a></li><li><a href="/td/zh/doc/fingerprint/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/zh/doc/fingerprint/js.html" class="sidebar-link">Web</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>验证码</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/captcha/android.html" class="sidebar-link">Android</a></li><li><a href="/td/zh/doc/captcha/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/zh/doc/captcha/js.html" aria-current="page" class="active sidebar-link">Web</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/td/zh/doc/captcha/weChat.html" class="sidebar-link">微信小程序</a></li><li><a href="/td/zh/doc/captcha/alipay.html" class="sidebar-link">支付宝小程序</a></li><li><a href="/td/zh/doc/captcha/byteDance.html" class="sidebar-link">字节小程序</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="集成前端-js"><a href="#集成前端-js" class="header-anchor">#</a> 集成前端 JS</h3> <p>将下列代码嵌入关键业务页面的 head 标签内，如登录页、注册页、密码找回页等需要进行人机验证的页面：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     _fmOpt <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">partner</span><span class="token operator">:</span> <span class="token string">'testpc'</span><span class="token punctuation">,</span> <span class="token comment">// 合作方标识</span>
        <span class="token literal-property property">appName</span><span class="token operator">:</span> <span class="token string">'testpc_web'</span><span class="token punctuation">,</span> <span class="token comment">// 应用标识</span>
        <span class="token literal-property property">display</span><span class="token operator">:</span> <span class="token string">'bind'</span><span class="token punctuation">,</span> <span class="token comment">// 绑定式</span>
        <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#captcha'</span><span class="token punctuation">,</span> <span class="token comment">// 指定触发验证码事件的DOM节点</span>
        <span class="token literal-property property">initialTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
    <span class="token keyword">var</span> fm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    fm<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
    <span class="token comment">// 将Base URL替换为相应环境资源地址</span>
    fm<span class="token punctuation">.</span>src <span class="token operator">=</span><span class="token string">'Base URL'</span> <span class="token operator">+</span> <span class="token string">'?t='</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Base URL</strong></p> <table><thead><tr><th>地区</th> <th>Base URL</th></tr></thead> <tbody><tr><td>中国</td> <td>https://static.tongdun.net/captcha/main/tdc.js</td></tr> <tr><td>北美</td> <td>https://static.tongdun.net/us/captcha/main/tdc.js</td></tr> <tr><td>新加坡</td> <td>https://static.tongdun.net/sg/captcha/main/tdc.js</td></tr> <tr><td>德国</td> <td>https://static.tongdun.net/fra/captcha/main/tdc.js</td></tr></tbody></table> <p><strong>注意：若您已接入过同盾设备指纹产品，请先删除页面内相关接入代码</strong></p> <h3 id="触发方式"><a href="#触发方式" class="header-anchor">#</a> 触发方式</h3> <table><thead><tr><th>触发方式</th> <th>说明</th></tr></thead> <tbody><tr><td>绑定式</td> <td>可指定触发验证码事件的Button，如登录/注册/发送短信等按钮</td></tr> <tr><td>触发式</td> <td>页面会渲染一个名为 <code>点击完成验证</code> 的独立的Button，点击该Button触发验证</td></tr></tbody></table> <h3 id="参数列表"><a href="#参数列表" class="header-anchor">#</a> 参数列表</h3> <p>配置参数是指 JS 接入代码中 <code>_fmOpt</code> 对象中的参数。除集成示例代码中参数基本设置外，您还可以结合以下参数说明做进一步配置。</p> <table><thead><tr><th>参数名</th> <th>类型</th> <th>是否必填</th> <th>说明</th></tr></thead> <tbody><tr><td>partner</td> <td>String</td> <td>是</td> <td>合作方标识，由同盾分配</td></tr> <tr><td>appName</td> <td>String</td> <td>是</td> <td>应用标识，由同盾分配</td></tr> <tr><td>display</td> <td>String</td> <td>是</td> <td>验证码弹窗展现形式，可选值为 popup/float/custom/bind。具体解释：<strong>popup</strong>：屏幕居中展示，并且验证码弹窗之外遮罩填充，点击遮罩可关闭验证码；<strong>float</strong>：浮动展示，验证码展现在指定的 Button 的上方；<strong>custom</strong>：验证码在 area 指定的 DOM 元素内展现；<strong>bind</strong>：对应绑定式，验证码触发方式由用户指定的 DOM 元素确定，验证码默认居中展示</td></tr> <tr><td>container</td> <td>String</td> <td>是</td> <td>ID、Class 或 Tag 形式的 DOM 选择器；对于绑定式，用于指定触发验证码事件的Button的DOM节点；对于触发式，用于指定'点击完成验证'按钮渲染的目标DOM节点</td></tr> <tr><td>area</td> <td>String</td> <td>否</td> <td>ID、Class 或 Tag 形式的 DOM 选择器；仅display为custom适用，用于指定验证码弹窗渲染的区域</td></tr> <tr><td>width</td> <td>String</td> <td>否</td> <td><strong>点击完成验证</strong>按钮长度，仅对非绑定式有效。默认值 300px，最小值 200px</td></tr> <tr><td>height</td> <td>String</td> <td>否</td> <td><strong>点击完成验证</strong>按钮高度，仅对非绑定式有效。默认值 40px，最小值 30px</td></tr> <tr><td>lang</td> <td>String</td> <td>否</td> <td>验证界面语言，目前可选语言为：zh-cn（中文简体），zh-han（中文繁体），en（英文），ja（日文），ko（韩文），默认为<strong>zh-cn</strong></td></tr> <tr><td>bindSucNoFed</td> <td>Boolean</td> <td>否</td> <td>绑定式接入时，验证成功后是否返回验证成功的弹框提示；<strong>false</strong>为有弹框提示，<strong>true</strong> 为没有弹框提示，默认值为 <strong>false</strong></td></tr> <tr><td>env</td> <td>Number</td> <td>否</td> <td>env 取值，1 表示线上环境，0 表示沙盒环境，不传则默认为线上；<strong>提示：正式发布时，线上环境请删除此变量或设置为 1</strong></td></tr> <tr><td>closeIcon</td> <td>Number</td> <td>否</td> <td>是否显示关闭图标，0 为显示，1 为不显示，默认值 0</td></tr> <tr><td>closeMask</td> <td>Number</td> <td>否</td> <td>点击遮罩区域是否可关闭验证码，0 为可以，1 为不可以，默认值 0</td></tr> <tr><td>mfaId</td> <td>String</td> <td>否</td> <td>如果您已对接MFA产品，请将MFA流程中接口获取的mfa_id赋值给验证码配置参数_fmOpt, 未对接可以忽略；示例: _fmOpt.mfaId = res.data.mfa_id;</td></tr></tbody></table> <h3 id="方法说明"><a href="#方法说明" class="header-anchor">#</a> 方法说明</h3> <p><strong>绑定方法，以下方法可根据需要定义在 <code>_fmOpt</code> 对象上</strong></p> <ul><li><strong>onSuccess(validateToken)：</strong> 验证成功回调，返回validateToken，示例：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>_fmOpt<span class="token punctuation">.</span><span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">validateToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">userName</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">pwd</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">token</span><span class="token operator">:</span> validateToken<span class="token punctuation">,</span><span class="token comment">// 获取到验证成功validateToken，提交至后台进行二次校验 </span>
        <span class="token literal-property property">blackBox</span><span class="token operator">:</span> _fmOpt<span class="token punctuation">.</span>getinfo <span class="token operator">?</span> _fmOpt<span class="token punctuation">.</span><span class="token function">getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 调用 _fmOpt.getinfo() 获取到设备指纹blackbox，提交至后台</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>onFail(msg)：</strong> 验证码失败回调，可选。回传参数 msg 说明：</li></ul> <table><thead><tr><th>msg</th> <th>说明</th></tr></thead> <tbody><tr><td>opFail</td> <td>用户进行滑动或点选验证，验证失败</td></tr> <tr><td>op2much</td> <td>用户尝试次数过多，需要重新激活验证界面（连续验证失败或刷新10次触发）</td></tr> <tr><td>noNetwork</td> <td>网络错误</td></tr> <tr><td>limit</td> <td>系统繁忙</td></tr></tbody></table> <ul><li><strong>beforeValidate</strong>: 针对绑定式，在点击按钮后，弹出验证码以前，如果需要相关前置校验，可定义此函数。该函数返回true，继续执行验证码逻辑，false则不再执行。可选，示例：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 判断用户名或密码为空时，提示用户并返回false，验证码不会被触发</span>
_fmOpt<span class="token punctuation">.</span><span class="token function-variable function">beforeValidate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">||</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请输入用户名或密码'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>onReady：</strong> 验证码初始化完成回调，可选。</li> <li><strong>onClose：</strong> 验证码弹窗关闭回调，可选。</li></ul> <p><strong>以下方法可根据需要选择调用</strong></p> <ul><li><strong>triggerCaptcha</strong>：验证码事件默认绑定在指定的button上，如果需要通过js直接触发，可使用该方法。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>_fmOpt<span class="token punctuation">.</span><span class="token function">triggerCaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 主动触发验证码</span>
</code></pre></div><ul><li><strong>reset：</strong> 重置验证码至初始状态。一般在已通过验证但后端校验错误，或多个验证码等场景下，需要激活验证码重新获取token，示例：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">userName</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">pwd</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">token</span><span class="token operator">:</span> validateToken<span class="token punctuation">,</span>
    <span class="token literal-property property">blackBox</span><span class="token operator">:</span> _fmOpt<span class="token punctuation">.</span>getinfo <span class="token operator">?</span> _fmOpt<span class="token punctuation">.</span><span class="token function">getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 调用_fmOpt.getinfo()获取设备指纹blackbox</span>
  
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">success</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _fmOpt<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 重置验证码，用户需再次请求验证码获取验证token</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>newCaptcha：</strong> 当一个页面需要展示多个验证码时，可以调用此函数初始化新验证码。此时需要传入新验证码配置参数，onSuccess等函数也需要绑定至新验证码对象。示例：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> secondCaptchaObj <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">display</span><span class="token operator">:</span> <span class="token string">'popup'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#area'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 建议在 _fmOpt.onReady 中触发 newCaptcha 方法</span>
<span class="token keyword">var</span> secondCaptcha <span class="token operator">=</span> _fmOpt<span class="token punctuation">.</span><span class="token function">newCaptcha</span><span class="token punctuation">(</span>secondCaptchaObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
secondCaptcha<span class="token punctuation">.</span><span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">validateToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'第二验证码验证成功! 获取的token为：'</span> <span class="token operator">+</span> validateToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h3> <p>Q：样式出现问题（例如验证码图片崩坏，布局不居中..）？</p> <div class="language-js extra-class"><pre class="language-js"><code>如果项目中强制设置全局样式，权重比验证码样式高，会导致样式被覆盖
例如：img <span class="token punctuation">{</span>
        <span class="token literal-property property">width</span><span class="token operator">:</span><span class="token number">100</span><span class="token operator">%</span> <span class="token operator">!</span>important<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>Q：绑定式，点击按钮验证码没有反应？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1.</span> 验证码配置是否按照对接文档放在头部加载
<span class="token number">2.</span> 绑定的按钮元素是否在配置加载时已存在，元素未渲染会导致验证码点击事件没有绑定
</code></pre></div><p>Q：验证码验证成功或失败，回调函数未触发？</p> <div class="language-js extra-class"><pre class="language-js"><code>onSuccess 和 onFail 和其他回调函数，需在初始化时就绑定在 _fmOpt 变量上，否则找不到回调函数，无法触发
</code></pre></div><p>Q：用 <code>_fmOpt.newCaptcha</code>创建的验证码实例，回调函数没有触发？</p> <div class="language-js extra-class"><pre class="language-js"><code>例：<span class="token keyword">var</span> secondCaptcha <span class="token operator">=</span> _fmOpt<span class="token punctuation">.</span><span class="token function">newCaptcha</span><span class="token punctuation">(</span>secondCaptchaObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
新的验证码回调需绑定在新建的secondCaptcha验证码实例上，不能在绑在_fmOpt上
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">:</span> <span class="time">2023/06/07 16:19:48</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/td/zh/doc/captcha/ios.html" class="prev">
        iOS
      </a></span> <span class="next"><a href="/td/zh/doc/captcha/weChat.html">
        微信小程序
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/td/assets/js/app.185a84cc.js" defer></script><script src="/td/assets/js/2.2e3d5896.js" defer></script><script src="/td/assets/js/52.39a8f530.js" defer></script>
  </body>
</html>
