<!DOCTYPE html>
<html lang="简体中文">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ios | trustdevice</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/td/logo/icon.png">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4430f3f32f20bc88a8d30fe02df17081";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s); })();
            </script>
    <meta name="description" content="">
    <meta name="google-site-verification" content="NSp25_zH--p8r461f1YcEUt0LX9s7oRnyP3iBTvANIQ">
    <meta name="baidu-site-verification" content="codeva-A2SMJcZcws">
    
    <link rel="preload" href="/td/assets/css/0.styles.a099e45a.css" as="style"><link rel="preload" href="/td/assets/js/app.d5f99f5a.js" as="script"><link rel="preload" href="/td/assets/js/2.2e3d5896.js" as="script"><link rel="preload" href="/td/assets/js/55.de43e73b.js" as="script"><link rel="prefetch" href="/td/assets/js/10.3633d7ef.js"><link rel="prefetch" href="/td/assets/js/11.2b9c240c.js"><link rel="prefetch" href="/td/assets/js/12.e9df2b49.js"><link rel="prefetch" href="/td/assets/js/13.0907d37c.js"><link rel="prefetch" href="/td/assets/js/14.5cee661f.js"><link rel="prefetch" href="/td/assets/js/15.163dbe66.js"><link rel="prefetch" href="/td/assets/js/16.3f7ec69b.js"><link rel="prefetch" href="/td/assets/js/17.e0e92a3e.js"><link rel="prefetch" href="/td/assets/js/18.b7c44b45.js"><link rel="prefetch" href="/td/assets/js/19.f3fdc9fc.js"><link rel="prefetch" href="/td/assets/js/20.4ce2f16d.js"><link rel="prefetch" href="/td/assets/js/21.9f58e076.js"><link rel="prefetch" href="/td/assets/js/22.60e866c1.js"><link rel="prefetch" href="/td/assets/js/23.75f67d14.js"><link rel="prefetch" href="/td/assets/js/24.7c417886.js"><link rel="prefetch" href="/td/assets/js/25.7ced5130.js"><link rel="prefetch" href="/td/assets/js/26.4e29552d.js"><link rel="prefetch" href="/td/assets/js/27.c528b1c4.js"><link rel="prefetch" href="/td/assets/js/28.1858c5da.js"><link rel="prefetch" href="/td/assets/js/29.bf9bfb41.js"><link rel="prefetch" href="/td/assets/js/3.2158ca86.js"><link rel="prefetch" href="/td/assets/js/30.abfb0999.js"><link rel="prefetch" href="/td/assets/js/31.af9c2105.js"><link rel="prefetch" href="/td/assets/js/32.2b5c02eb.js"><link rel="prefetch" href="/td/assets/js/33.3417da35.js"><link rel="prefetch" href="/td/assets/js/34.2ef87457.js"><link rel="prefetch" href="/td/assets/js/35.67108cd7.js"><link rel="prefetch" href="/td/assets/js/36.4f7e50ed.js"><link rel="prefetch" href="/td/assets/js/37.aa01d190.js"><link rel="prefetch" href="/td/assets/js/38.9d0cb43b.js"><link rel="prefetch" href="/td/assets/js/39.eb124847.js"><link rel="prefetch" href="/td/assets/js/4.2885e313.js"><link rel="prefetch" href="/td/assets/js/40.7f1dfaed.js"><link rel="prefetch" href="/td/assets/js/41.7e8d4422.js"><link rel="prefetch" href="/td/assets/js/42.ddd6a49c.js"><link rel="prefetch" href="/td/assets/js/43.c0676a63.js"><link rel="prefetch" href="/td/assets/js/44.b4ed9425.js"><link rel="prefetch" href="/td/assets/js/45.f7fa5a91.js"><link rel="prefetch" href="/td/assets/js/46.eb23c720.js"><link rel="prefetch" href="/td/assets/js/47.21918068.js"><link rel="prefetch" href="/td/assets/js/48.6944f99d.js"><link rel="prefetch" href="/td/assets/js/49.0e78f848.js"><link rel="prefetch" href="/td/assets/js/5.102392b0.js"><link rel="prefetch" href="/td/assets/js/50.3d5344b5.js"><link rel="prefetch" href="/td/assets/js/51.502adbfd.js"><link rel="prefetch" href="/td/assets/js/52.41f0516c.js"><link rel="prefetch" href="/td/assets/js/53.86260b02.js"><link rel="prefetch" href="/td/assets/js/54.4536f93c.js"><link rel="prefetch" href="/td/assets/js/56.2de7f926.js"><link rel="prefetch" href="/td/assets/js/57.8476743f.js"><link rel="prefetch" href="/td/assets/js/58.93c9de17.js"><link rel="prefetch" href="/td/assets/js/59.0bea9c2e.js"><link rel="prefetch" href="/td/assets/js/6.ea70f831.js"><link rel="prefetch" href="/td/assets/js/7.0c6511fb.js"><link rel="prefetch" href="/td/assets/js/8.2b8a16fc.js"><link rel="prefetch" href="/td/assets/js/9.29164caf.js">
    <link rel="stylesheet" href="/td/assets/css/0.styles.a099e45a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/td/zh/" class="home-link router-link-active"><img src="/td/logo/icon.png" alt="trustdevice" class="logo"> <span class="site-name can-hide">trustdevice</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/fingerprint/ios.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/fingerprint/ios.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/fingerprint/ios.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/fingerprint/ios.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/" aria-current="page" class="sidebar-link">总览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>设备指纹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/fingerprint/android.html" class="sidebar-link">Android</a></li><li><a href="/td/zh/doc/fingerprint/ios.html" aria-current="page" class="active sidebar-link">iOS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#合规说明" class="sidebar-link">合规说明</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#环境要求" class="sidebar-link">环境要求</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#cocoapods集成" class="sidebar-link">CocoaPods集成</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#sdk目录" class="sidebar-link">SDK目录</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#引入头文件" class="sidebar-link">引入头文件</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#sdk初始化" class="sidebar-link">SDK初始化</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#获取sdk版本号" class="sidebar-link">获取SDK版本号</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#initwithoptions选传参数" class="sidebar-link">initWithOptions选传参数</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/ios.html#获取blackbox" class="sidebar-link">获取blackbox</a></li></ul></li><li><a href="/td/zh/doc/fingerprint/js.html" class="sidebar-link">Web</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>验证码</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/captcha/android.html" class="sidebar-link">Android</a></li><li><a href="/td/zh/doc/captcha/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/zh/doc/captcha/js.html" class="sidebar-link">Web</a></li><li><a href="/td/zh/doc/captcha/weChat.html" class="sidebar-link">微信小程序</a></li><li><a href="/td/zh/doc/captcha/alipay.html" class="sidebar-link">支付宝小程序</a></li><li><a href="/td/zh/doc/captcha/byteDance.html" class="sidebar-link">字节小程序</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="集成要求"><a href="#集成要求" class="header-anchor">#</a> 集成要求</h1> <h2 id="合规说明"><a href="#合规说明" class="header-anchor">#</a> 合规说明</h2> <p>请注意，在贵司的App中集成同盾提供的SDK产品时:</p> <p>1.1 根据《网络安全法》《电信条例》《电信和互联网用户个人信息保护规定》等相关法律法规要求及监管实践中的标准，在贵司的最终用户首次启动App并在贵司开始采集信息之前，贵司应以交互界面或设计（如隐私政策弹窗等）向最终用户完整告知收集、使用、与第三方共享最终用户个人信息的目的、方式和范围，并征得最终用户的明示同意。</p> <p>1.2 为向贵司提供业务安全和风控服务，同盾SDK将采集、处理、使用用户的手机终端唯一标志信息（IMEI/IDFA）、Android ID、IMSI、MEID、MAC 地址、SIM 卡序列号、设备序列号、设备类型、设备型号、系统类型、地理位置、登录 IP 地址等设备信息。为确保贵司使用相关服务的合规性，前述隐私政策应涵盖对同盾SDK提供服务并采集、处理、使用相关信息的授权，以下条款内容供贵司参考，具体表述可由贵司根据贵司隐私协议的整体框架和内容自行确定：</p> <table border="1"><tr><td style="background-color:#FAFAFA;"><font size="2">同盾SDK：为了业务安全和风控，我司使用了同盾 SDK，该 SDK 需要获取您的手机终端唯一标志信息（IMEI/IDFA）、Android ID、IMSI、MEID、MAC 地址、SIM卡序列号、设备序列号、设备类型、设备型号、系统类型、地理位置、登录 IP 地址、应用程序列表、运行中进程信息、传感器（光传感器、重力传感器、磁场传感器、加速度传感器、陀螺仪传感器）相关设备信息，用于设备欺诈风险识别。</font></td></tr></table> <p>同盾隐私协议：<a href="https://www.tongdun.cn/other/privacy/id=1" target="_blank" rel="noopener noreferrer">https://www.tongdun.cn/other/privacy/id=1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="环境要求"><a href="#环境要求" class="header-anchor">#</a> 环境要求</h2> <table><thead><tr><th>条目</th> <th>说明</th></tr></thead> <tbody><tr><td>兼容版本</td> <td>iOS9.0+</td></tr> <tr><td>支持架构</td> <td>armv7, arm64, x86_64</td></tr></tbody></table> <h1 id="集成步骤"><a href="#集成步骤" class="header-anchor">#</a> 集成步骤</h1> <h2 id="cocoapods集成"><a href="#cocoapods集成" class="header-anchor">#</a> CocoaPods集成</h2> <ul><li>在 Podfile 文件中对应 target 中新增 <code>pod 'TrustDecisionPro', '4.2.4.2'</code></li> <li>在 Podfile 所在文件夹中执行 <code>pod install --repo-update</code> 命令 (M1系列mac电脑需要执行 <code>arch -x86_64 pod install --repo-update</code> 命令)</li></ul> <h2 id="sdk目录"><a href="#sdk目录" class="header-anchor">#</a> SDK目录</h2> <p>Pods/TrustDecisionPro 文件夹下存在如下文件:</p> <ul><li>TDMobRisk.framework（终端SDK主文件，静态库类型）</li> <li>TDCorePlugin.framework （终端SDK依赖核心插件，Embed动态库类型）</li></ul> <h2 id="引入头文件"><a href="#引入头文件" class="header-anchor">#</a> 引入头文件</h2> <p>在调用的位置引入头文件
Objective C</p> <div class="language-objective extra-class"><pre class="language-text"><code>#import &lt;TDMobRisk/TDMobRisk.h&gt;
</code></pre></div><p>Swift</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">import</span> <span class="token class-name">TDMobRisk</span>
</code></pre></div><h2 id="sdk初始化"><a href="#sdk初始化" class="header-anchor">#</a> SDK初始化</h2> <p><strong>注意事项</strong></p> <p>安装后首次启动时，在用户同意隐私协议后，再进行SDK初始化。
避免出现用户未同意隐私协议就进行SDK初始化采集，引发合规风险事故。</p> <p><strong>接口定义</strong></p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>initWithOptions<span class="token punctuation">)</span><span class="token punctuation">(</span>NSDictionary <span class="token operator">*</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>示例代码</strong>
Objective C</p> <div class="language-objective extra-class"><pre class="language-text"><code>- (void)initTrustDecisionSDK:(void (^)(NSString *blackbox))callback {
  TDMobRiskManager_t *riskManager = [TDMobRiskManager sharedManager];
  NSMutableDictionary *options = [NSMutableDictionary dictionary];
  
  /*************************** 必传 ***************************/
  // 合作方编码，如tongdun，参考下面`必传配置`
  [options setValue:@&quot;请输入您的合作方编码&quot; forKey:@&quot;partner&quot;];
  // 同盾平台注册的应用标识，参考下面`必传配置`
  [options setValue:@&quot;请输入您的appKey&quot; forKey:@&quot;appKey&quot;];
  // 同盾平台注册的应用名称，参考下面`必传配置`
  [options setValue:@&quot;请输入您的appName&quot; forKey:@&quot;appName&quot;];
  // 国家地区参数，参考下面`必传配置`
  [options setValue:@&quot;请输入您所在的国家地区&quot; forKey:@&quot;country&quot;];

  /*************************** 选传 ***************************/
#ifdef DEBUG
  // !!! DEBUG模式下若不设置此参数，app运行会闪退
  [options setValue:@&quot;allowed&quot; forKey:@&quot;allowed&quot;];
#endif

  [options setValue:^(NSString *blackbox) {
    // 此处回调在子线程
    // 网络正常的情况下，会在200-300ms内返回结果。
    // 网络异常的情况下，会在超时时间timeLimit（默认最长15s）后返回。
    // 请在下方添加您对blackbox的处理逻辑
    if (callback) {
        callback(blackbox);
    }
  } forKey:@&quot;callback&quot;];
  riskManager-&gt;initWithOptions(options);
}
</code></pre></div><p>Swift</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token keyword">func</span> <span class="token function-definition function">initTrustDecisionSDK</span><span class="token punctuation">(</span>callback<span class="token punctuation">:</span> <span class="token attribute atrule">@escaping</span> <span class="token punctuation">(</span><span class="token omit keyword">_</span> blackBox<span class="token punctuation">:</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> riskManager <span class="token operator">=</span> <span class="token class-name">TDMobRiskManager</span><span class="token punctuation">.</span><span class="token function">sharedManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token class-name">String</span> <span class="token punctuation">:</span> <span class="token class-name">NSObject</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">/*************************** 必传 ***************************/</span>
  <span class="token comment">// 合作方编码，如tongdun，参考下面`必传配置`</span>
  options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;请输入您的合作方编码&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;partner&quot;</span></span><span class="token punctuation">)</span>
  <span class="token comment">// 同盾平台注册的应用标识，参考下面`必传配置`</span>
  options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;请输入您的appKey&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;appKey&quot;</span></span><span class="token punctuation">)</span>
  <span class="token comment">// 同盾平台注册的应用名称，参考下面`必传配置`</span>
  options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;请输入您的appName&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;appName&quot;</span></span><span class="token punctuation">)</span>
  <span class="token comment">// 国家地区参数，参考下面`必传配置`</span>
  options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;请输入您所在的国家地区&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;country&quot;</span></span><span class="token punctuation">)</span>

  <span class="token comment">/*************************** 选传 ***************************/</span>
<span class="token directive property"><span class="token directive-name">#if</span> DEBUG</span>
  <span class="token comment">// !!! DEBUG模式下若不设置此参数，app运行会闪退</span>
  options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;allowed&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;allowed&quot;</span></span><span class="token punctuation">)</span>
<span class="token directive property"><span class="token directive-name">#endif</span></span>

  <span class="token keyword">let</span> tdcallback<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span> <span class="token class-name">Void</span> <span class="token operator">=</span> <span class="token punctuation">{</span>blackBox <span class="token keyword">in</span>
   <span class="token comment">// 此处回调在子线程</span>
   <span class="token comment">// 网络正常的情况下，会在200-300ms内返回结果。</span>
   <span class="token comment">// 网络异常的情况下，会在超时时间timeLimit（默认最长15s）后返回。</span>
   <span class="token comment">// 请在下方添加您对blackbox的处理逻辑</span>
   <span class="token function">callback</span><span class="token punctuation">(</span>blackBox<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  options<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;callback&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">unsafeBitCast</span><span class="token punctuation">(</span>tdcallback <span class="token keyword">as</span> <span class="token attribute atrule">@convention</span><span class="token punctuation">(</span>block<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">Void</span><span class="token punctuation">,</span> to<span class="token punctuation">:</span> <span class="token class-name">AnyObject</span><span class="token punctuation">.</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token keyword">as</span><span class="token operator">?</span> <span class="token class-name">NSObject</span>
  riskManager<span class="token operator">?</span><span class="token punctuation">.</span>pointee<span class="token punctuation">.</span><span class="token function">initWithOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>必传配置</strong></p> <table><thead><tr><th>配置 key</th> <th>定义</th> <th>说明</th> <th>场景</th> <th>示例代码</th></tr></thead> <tbody><tr><td>partner</td> <td>合作方编码</td> <td>同盾的合作方编码，请联系同盾运营获取</td> <td>所有场景</td> <td><strong>Objective C</strong> [options setValue:@&quot;请输入您的合作方编码&quot; forKey:@&quot;partner&quot;]; <strong>Swift</strong> options.updateValue(&quot;请输入您的合作方编码&quot; as NSObject, forKey: &quot;partner&quot;)</td></tr> <tr><td>appKey</td> <td>应用标识</td> <td>同盾生成的应用标识，和app绑定，用于校验app的有效性，请联系同盾运营获取 appkey创建需要用户提供应用包名、小写的sha256 签名。 ⚠️不同应用的包名签名不要使用相同的值</td> <td>所有场景</td> <td><strong>Objective C</strong> [options setValue:@&quot;请输入您的appKey&quot; forKey:@&quot;appKey&quot;]; <strong>Swift</strong> options.updateValue(&quot;请输入您的appKey&quot; as NSObject, forKey: &quot;appKey&quot;)</td></tr> <tr><td>appName</td> <td>应用名称</td> <td>同盾平台注册的应用名称，请联系同盾运营获取</td> <td>所有场景</td> <td><strong>Objective C</strong> [options setValue:@&quot;请输入您的appName&quot; forKey:@&quot;appName&quot;]; <strong>Swift</strong> options.updateValue(&quot;请输入您的appName&quot; as NSObject, forKey: &quot;appName&quot;)</td></tr> <tr><td>country</td> <td>国家地区</td> <td>国家地区参数，如cn sg us fra</td> <td>根据国家地区填写对应参数。 cn代表中国， sg代表新加坡， us代表北美， fra代表欧洲</td> <td><strong>Objective C</strong> [options setValue:@&quot;请输入您所在的国家地区&quot; forKey:@&quot;country&quot;]; <strong>Swift</strong> options.updateValue(&quot;请输入您所在的国家地区&quot; as NSObject, forKey: &quot;country&quot;)</td></tr></tbody></table> <h2 id="获取sdk版本号"><a href="#获取sdk版本号" class="header-anchor">#</a> 获取SDK版本号</h2> <p><strong>示例代码</strong>
Objective C</p> <div class="language-objective extra-class"><pre class="language-text"><code>// 获取SDK版本号
TDMobRiskManager_t *riskManager = [TDMobRiskManager sharedManager];
NSString *sdkVersion = riskManager-&gt;getSDKVersion();
</code></pre></div><p>Swift</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">// 获取SDK版本号</span>
<span class="token keyword">let</span> riskManager <span class="token operator">=</span> <span class="token class-name">TDMobRiskManager</span><span class="token punctuation">.</span><span class="token function">sharedManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> sdkVersion <span class="token operator">=</span> riskManager<span class="token operator">?</span><span class="token punctuation">.</span>pointee<span class="token punctuation">.</span><span class="token function">getSDKVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="设备指纹功能模块"><a href="#设备指纹功能模块" class="header-anchor">#</a> 设备指纹功能模块</h1> <h2 id="initwithoptions选传参数"><a href="#initwithoptions选传参数" class="header-anchor">#</a> initWithOptions选传参数</h2> <table><thead><tr><th>配置 key</th> <th>定义</th> <th>说明</th> <th>场景</th> <th>示例代码</th></tr></thead> <tbody><tr><td>allowed</td> <td>SDK反调试配置</td> <td>集成SDK后App默认具有反调试功能，开发者根据具体情况进行对应设置</td> <td>**开发阶段：**Xcode调试请打开此配置 **打包测试/上架阶段：**移除此配置</td> <td><strong>Objective C</strong> [options setValue:@&quot;allowed&quot; forKey:@&quot;allowed&quot;]; <strong>Swift</strong> options.updateValue(&quot;allowed&quot; as NSObject, forKey: &quot;allowed&quot;)</td></tr> <tr><td>timeLimit</td> <td>SDK超时时间配置（单位:秒）</td> <td>SDK初始化采集上报后，网络请求回调的超时时间，SDK默认为15s</td> <td>开发者需要控制SDK上报以后的网络请求超时时间，请设置此配置</td> <td><strong>Objective C</strong> [options setValue:@&quot;5&quot; forKey:@&quot;timeLimit&quot;]; <strong>Swift</strong> options.updateValue(&quot;5&quot; as NSObject, forKey: &quot;timeLimit&quot;)</td></tr> <tr><td>noLocation</td> <td>SDK地理定位信息采集配置</td> <td>SDK本身不主动进行定位授权，完全依赖App的权限</td> <td>禁止SDK获取定位信息，请设置此配置</td> <td><strong>Objective C</strong> [options setValue:@&quot;noLocation&quot; forKey:@&quot;noLocation&quot;]; <strong>Swift</strong> options.updateValue(&quot;noLocation&quot; as NSObject, forKey: &quot;noLocation&quot;)</td></tr> <tr><td>noIDFA</td> <td>SDK广告标识符（IDFA）采集配置</td> <td>SDK本身不主动进行广告标识符授权，完全依赖App的权限设置此配置后，可以通过苹果对于广告标识符的静态扫码检查</td> <td>禁止SDK获取和执行广告标识符（IDFA）相关代码，请设置此配置</td> <td><strong>Objective C</strong> [options setValue:@&quot;noIDFA&quot; forKey:@&quot;noIDFA&quot;]; <strong>Swift</strong> options.updateValue(&quot;noIDFA&quot; as NSObject, forKey: &quot;noIDFA&quot;)</td></tr> <tr><td>noDeviceName</td> <td>设备名称（deviceName）采集配置</td> <td>集成SDK后，SDK默认会采集当前设备名称，开发者根据具体情况进行对应设置</td> <td>禁止SDK采集设备名称，请设置此配置</td> <td><strong>Objective C</strong> [options setValue:@&quot;noDeviceName&quot; forKey:@&quot;noDeviceName&quot;]; <strong>Swift</strong> options.updateValue(&quot;noDeviceName&quot; as NSObject, forKey: &quot;noDeviceName&quot;)</td></tr> <tr><td>callback</td> <td>SDK异步回调配置</td> <td>SDK初始化采集上报后，根据网络请求结果返回blackbox。 <strong>请求成功：</strong> 返回非降级blackbox <strong>请求失败：</strong> 返回降级blackbox</td> <td>尽可能获取到非降级blackbox</td> <td><strong>Objective C</strong> [options setValue:^(NSString *blackbox) {} forKey:@&quot;callback&quot;]; <strong>Swift</strong> let callback: (String)-&gt; Void = {blackBox in } options[&quot;callback&quot;] = unsafeBitCast(callback as @convention(block) (String) -&gt; Void, to: AnyObject.self) as? NSObject</td></tr> <tr><td>collectLevel</td> <td>降级blackbox采集字段长度配置</td> <td>降级的blackbox会较长。通过此配置可控制降级的blackbox长度</td> <td>需要blackbox长度较短时建议使用此配置 <strong>不设置：</strong> 降级blackbox长度为5000个字符左右（根据实际设备情况会有上浮） **设置：**降级blackbox长度为2000个字符左右</td> <td><strong>Objective C</strong> [options setValue:@&quot;M&quot; forKey:@&quot;collectLevel&quot;]; <strong>Swift</strong> options.updateValue(&quot;M&quot; as NSObject, forKey: &quot;collectLevel&quot;)</td></tr></tbody></table> <h2 id="获取blackbox"><a href="#获取blackbox" class="header-anchor">#</a> 获取blackbox</h2> <p><strong>注意事项</strong></p> <ul><li>请在 <code>initWithOptions</code>后 <code>getBlackBox</code>，否则会引起SDK异常</li> <li>建议开发者不要在App内对 <code>getBlackBox</code>返回的结果进行缓存，获取blackbox请依赖此函数</li></ul> <p><strong>示例代码</strong>
Objective C</p> <div class="language-objective extra-class"><pre class="language-text"><code>// 同步获取blackbox，未进行SDK初始化禁止调用，否则会引起SDK异常。
TDMobRiskManager_t *riskManager = [TDMobRiskManager sharedManager];
NSString *blackbox = riskManager-&gt;getBlackBox();
</code></pre></div><p>Swift</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">// 同步获取blackbox，未进行SDK初始化禁止调用，否则会引起SDK异常。</span>
<span class="token keyword">let</span> riskManager <span class="token operator">=</span> <span class="token class-name">TDMobRiskManager</span><span class="token punctuation">.</span><span class="token function">sharedManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> blackBox <span class="token operator">=</span> riskManager<span class="token operator">?</span><span class="token punctuation">.</span>pointee<span class="token punctuation">.</span><span class="token function">getBlackBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h1> <p><strong>Q1</strong>：引入终端SDK后，工程无法再进行 Xcode 调试，如何解决？</p> <p><strong>A1</strong>：请参考 <a href="https://doc.trustdecision.com/API?article=36952&amp;version=152#SDK%E5%88%9D%E5%A7%8B%E5%8C%96" target="_blank" rel="noopener noreferrer">SDK初始化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在终端SDK初始化时，加入如下参数
Objective C</p> <div class="language-objective extra-class"><pre class="language-text"><code>[options setValue:@&quot;allowed&quot; forKey:@&quot;allowed&quot;];
</code></pre></div><p>Swift</p> <div class="language-swift extra-class"><pre class="language-swift"><code>options<span class="token punctuation">.</span><span class="token function">updateValue</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;allowed&quot;</span></span> <span class="token keyword">as</span> <span class="token class-name">NSObject</span><span class="token punctuation">,</span> forKey<span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">&quot;allowed&quot;</span></span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">:</span> <span class="time">2023/06/07 16:19:48</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/td/zh/doc/fingerprint/android.html" class="prev">
        Android
      </a></span> <span class="next"><a href="/td/zh/doc/fingerprint/js.html">
        Web
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/td/assets/js/app.d5f99f5a.js" defer></script><script src="/td/assets/js/2.2e3d5896.js" defer></script><script src="/td/assets/js/55.de43e73b.js" defer></script>
  </body>
</html>
