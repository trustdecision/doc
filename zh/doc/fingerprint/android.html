<!DOCTYPE html>
<html lang="简体中文">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android | trustdevice</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/td/logo/icon.png">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4430f3f32f20bc88a8d30fe02df17081";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s); })();
            </script>
    <meta name="description" content="">
    <meta name="google-site-verification" content="NSp25_zH--p8r461f1YcEUt0LX9s7oRnyP3iBTvANIQ">
    <meta name="baidu-site-verification" content="codeva-A2SMJcZcws">
    
    <link rel="preload" href="/td/assets/css/0.styles.a099e45a.css" as="style"><link rel="preload" href="/td/assets/js/app.d5f99f5a.js" as="script"><link rel="preload" href="/td/assets/js/2.2e3d5896.js" as="script"><link rel="preload" href="/td/assets/js/54.4536f93c.js" as="script"><link rel="prefetch" href="/td/assets/js/10.3633d7ef.js"><link rel="prefetch" href="/td/assets/js/11.2b9c240c.js"><link rel="prefetch" href="/td/assets/js/12.e9df2b49.js"><link rel="prefetch" href="/td/assets/js/13.0907d37c.js"><link rel="prefetch" href="/td/assets/js/14.5cee661f.js"><link rel="prefetch" href="/td/assets/js/15.163dbe66.js"><link rel="prefetch" href="/td/assets/js/16.3f7ec69b.js"><link rel="prefetch" href="/td/assets/js/17.e0e92a3e.js"><link rel="prefetch" href="/td/assets/js/18.b7c44b45.js"><link rel="prefetch" href="/td/assets/js/19.f3fdc9fc.js"><link rel="prefetch" href="/td/assets/js/20.4ce2f16d.js"><link rel="prefetch" href="/td/assets/js/21.9f58e076.js"><link rel="prefetch" href="/td/assets/js/22.60e866c1.js"><link rel="prefetch" href="/td/assets/js/23.75f67d14.js"><link rel="prefetch" href="/td/assets/js/24.7c417886.js"><link rel="prefetch" href="/td/assets/js/25.7ced5130.js"><link rel="prefetch" href="/td/assets/js/26.4e29552d.js"><link rel="prefetch" href="/td/assets/js/27.c528b1c4.js"><link rel="prefetch" href="/td/assets/js/28.1858c5da.js"><link rel="prefetch" href="/td/assets/js/29.bf9bfb41.js"><link rel="prefetch" href="/td/assets/js/3.2158ca86.js"><link rel="prefetch" href="/td/assets/js/30.abfb0999.js"><link rel="prefetch" href="/td/assets/js/31.af9c2105.js"><link rel="prefetch" href="/td/assets/js/32.2b5c02eb.js"><link rel="prefetch" href="/td/assets/js/33.3417da35.js"><link rel="prefetch" href="/td/assets/js/34.2ef87457.js"><link rel="prefetch" href="/td/assets/js/35.67108cd7.js"><link rel="prefetch" href="/td/assets/js/36.4f7e50ed.js"><link rel="prefetch" href="/td/assets/js/37.aa01d190.js"><link rel="prefetch" href="/td/assets/js/38.9d0cb43b.js"><link rel="prefetch" href="/td/assets/js/39.eb124847.js"><link rel="prefetch" href="/td/assets/js/4.2885e313.js"><link rel="prefetch" href="/td/assets/js/40.7f1dfaed.js"><link rel="prefetch" href="/td/assets/js/41.7e8d4422.js"><link rel="prefetch" href="/td/assets/js/42.ddd6a49c.js"><link rel="prefetch" href="/td/assets/js/43.c0676a63.js"><link rel="prefetch" href="/td/assets/js/44.b4ed9425.js"><link rel="prefetch" href="/td/assets/js/45.f7fa5a91.js"><link rel="prefetch" href="/td/assets/js/46.eb23c720.js"><link rel="prefetch" href="/td/assets/js/47.21918068.js"><link rel="prefetch" href="/td/assets/js/48.6944f99d.js"><link rel="prefetch" href="/td/assets/js/49.0e78f848.js"><link rel="prefetch" href="/td/assets/js/5.102392b0.js"><link rel="prefetch" href="/td/assets/js/50.3d5344b5.js"><link rel="prefetch" href="/td/assets/js/51.502adbfd.js"><link rel="prefetch" href="/td/assets/js/52.41f0516c.js"><link rel="prefetch" href="/td/assets/js/53.86260b02.js"><link rel="prefetch" href="/td/assets/js/55.de43e73b.js"><link rel="prefetch" href="/td/assets/js/56.2de7f926.js"><link rel="prefetch" href="/td/assets/js/57.8476743f.js"><link rel="prefetch" href="/td/assets/js/58.93c9de17.js"><link rel="prefetch" href="/td/assets/js/59.0bea9c2e.js"><link rel="prefetch" href="/td/assets/js/6.ea70f831.js"><link rel="prefetch" href="/td/assets/js/7.0c6511fb.js"><link rel="prefetch" href="/td/assets/js/8.2b8a16fc.js"><link rel="prefetch" href="/td/assets/js/9.29164caf.js">
    <link rel="stylesheet" href="/td/assets/css/0.styles.a099e45a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/td/zh/" class="home-link router-link-active"><img src="/td/logo/icon.png" alt="trustdevice" class="logo"> <span class="site-name can-hide">trustdevice</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/fingerprint/android.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/fingerprint/android.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/td/zh/doc/" class="nav-link router-link-active">
  使用文档
</a></div><div class="nav-item"><a href="/td/zh/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/fingerprint/android.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/fingerprint/android.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/" aria-current="page" class="sidebar-link">总览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>设备指纹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/fingerprint/android.html" aria-current="page" class="active sidebar-link">Android</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#合规说明" class="sidebar-link">合规说明</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#环境要求" class="sidebar-link">环境要求</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#集成sdk" class="sidebar-link">集成SDK</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#文件配置-androidmanifest-xml" class="sidebar-link">文件配置 AndroidManifest.xml</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#sdk-的使用方法" class="sidebar-link">SDK 的使用方法</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#获取sdk版本号" class="sidebar-link">获取SDK版本号</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#其他说明" class="sidebar-link">其他说明</a></li><li class="sidebar-sub-header"><a href="/td/zh/doc/fingerprint/android.html#初始化配置可选参数列表" class="sidebar-link">初始化配置可选参数列表</a></li></ul></li><li><a href="/td/zh/doc/fingerprint/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/zh/doc/fingerprint/js.html" class="sidebar-link">Web</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>验证码</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/zh/doc/captcha/android.html" class="sidebar-link">Android</a></li><li><a href="/td/zh/doc/captcha/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/zh/doc/captcha/js.html" class="sidebar-link">Web</a></li><li><a href="/td/zh/doc/captcha/weChat.html" class="sidebar-link">微信小程序</a></li><li><a href="/td/zh/doc/captcha/alipay.html" class="sidebar-link">支付宝小程序</a></li><li><a href="/td/zh/doc/captcha/byteDance.html" class="sidebar-link">字节小程序</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="集成要求"><a href="#集成要求" class="header-anchor">#</a> 集成要求</h1> <h2 id="合规说明"><a href="#合规说明" class="header-anchor">#</a> 合规说明</h2> <p>请注意，在贵司的App中集成同盾提供的SDK产品时:</p> <p>1.1 根据《网络安全法》《电信条例》《电信和互联网用户个人信息保护规定》等相关法律法规要求及监管实践中的标准，在贵司的最终用户首次启动App并在贵司开始采集信息之前，贵司应以交互界面或设计（如隐私政策弹窗等）向最终用户完整告知收集、使用、与第三方共享最终用户个人信息的目的、方式和范围，并征得最终用户的明示同意。</p> <p>1.2 为向贵司提供业务安全和风控服务，同盾SDK将采集、处理、使用用户的手机终端唯一标志信息（IMEI/IDFA）、Android ID、IMSI、MEID、MAC 地址、SIM 卡序列号、设备序列号、设备类型、设备型号、系统类型、地理位置、登录 IP 地址等设备信息。为确保贵司使用相关服务的合规性，前述隐私政策应涵盖对同盾SDK提供服务并采集、处理、使用相关信息的授权，以下条款内容供贵司参考，具体表述可由贵司根据贵司隐私协议的整体框架和内容自行确定：
<table border="1"><tr><td style="background-color:#FAFAFA;"><font size="2">同盾SDK：为了业务安全和风控，我司使用了同盾 SDK，该 SDK 需要获取您的手机终端唯一标志信息（IMEI/IDFA）、Android ID、IMSI、MEID、MAC 地址、SIM卡序列号、设备序列号、设备类型、设备型号、系统类型、地理位置、登录 IP 地址、应用程序列表、运行中进程信息、传感器（光传感器、重力传感器、磁场传感器、加速度传感器、陀螺仪传感器）相关设备信息，用于设备欺诈风险识别。</font></td></tr></table></p> <p>同盾隐私协议：<a href="https://www.tongdun.cn/other/privacy/id=1" target="_blank" rel="noopener noreferrer">https://www.tongdun.cn/other/privacy/id=1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="环境要求"><a href="#环境要求" class="header-anchor">#</a> 环境要求</h2> <table><thead><tr><th>条目</th> <th>说明</th></tr></thead> <tbody><tr><td>兼容版本</td> <td>支持主流机型，Android 4.4及以上系统</td></tr> <tr><td>支持架构</td> <td>armeabi-v7a, arm64-v8a, x86</td></tr></tbody></table> <h1 id="集成步骤"><a href="#集成步骤" class="header-anchor">#</a> 集成步骤</h1> <h2 id="集成sdk"><a href="#集成sdk" class="header-anchor">#</a> 集成SDK</h2> <p><strong>注意:</strong> 已经在⼯程libs中集成SDK的客户，在升级新版本SDK时，请先删除旧版 SDK，如有旧版本集成的so库也需要同时删除。</p> <p><strong>SDK接入示例代码(sample):</strong> <a href="https://github.com/trustdecision/mobrisk-android-sample" target="_blank" rel="noopener noreferrer">https://github.com/trustdecision/mobrisk-android-sample<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="添加仓库"><a href="#添加仓库" class="header-anchor">#</a> 添加仓库</h3> <p>首先, 请在项目根目录的 <code>build.gradle</code>加入maven库的配置</p> <div class="language-java extra-class"><pre class="language-java"><code>allprojects <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果您的 Gradle 版本是 7 或更高版本，请将这些行添加到您的 <code>settings.gradle</code></p> <div class="language-java extra-class"><pre class="language-java"><code>repositories <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="添加依赖"><a href="#添加依赖" class="header-anchor">#</a> 添加依赖</h3> <p>在项目的 <code>app/build.gradle</code> 中加上依赖，如图：</p> <div class="language-java extra-class"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
    <span class="token comment">// 设备指纹</span>
    implementation 'com<span class="token punctuation">.</span>trustdecision<span class="token punctuation">.</span>android<span class="token operator">:</span>mobrisk<span class="token operator">:</span><span class="token number">4.2</span><span class="token number">.4</span><span class="token number">.2</span>'
 <span class="token punctuation">}</span>
</code></pre></div><p>如果遇到合规性问题，我们也可以在依赖阶段排除相关模块的采集，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
    <span class="token comment">// 设备指纹</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span>'com<span class="token punctuation">.</span>trustdecision<span class="token punctuation">.</span>android<span class="token operator">:</span>mobrisk<span class="token operator">:</span><span class="token number">4.2</span><span class="token number">.4</span><span class="token number">.2</span>'<span class="token punctuation">)</span><span class="token punctuation">{</span>
    	<span class="token comment">// 移除后sdk不获取安装包列表</span>
        exclude group<span class="token operator">:</span> 'com<span class="token punctuation">.</span>trustdecision<span class="token punctuation">.</span>android'<span class="token punctuation">,</span> <span class="token keyword">module</span><span class="token operator">:</span> 'packagelist'
        <span class="token comment">// 移除后sdk不会收集READ_PHONE_STATE相关信息</span>
        exclude group<span class="token operator">:</span> 'com<span class="token punctuation">.</span>trustdecision<span class="token punctuation">.</span>android'<span class="token punctuation">,</span> <span class="token keyword">module</span><span class="token operator">:</span> 'readphone'
    <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="abi类型"><a href="#abi类型" class="header-anchor">#</a> ABI类型</h3> <p>SDK目前支持 armeabi-v7a、arm64-v8a、x86三种ABI类型，建议接入方在 <code>app/build.gradle</code>文件内添加 <code>abiFilters</code>配置选择所需要的架构类型，示例</p> <div class="language-java extra-class"><pre class="language-java"><code>defaultConfig <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    ndk <span class="token punctuation">{</span>
       abiFilters 'armeabi<span class="token operator">-</span>v7a<span class="token char">', '</span>arm64<span class="token operator">-</span>v8a'
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体架构，请以您自己需要支持的架构为准！</p> <h2 id="文件配置-androidmanifest-xml"><a href="#文件配置-androidmanifest-xml" class="header-anchor">#</a> 文件配置 AndroidManifest.xml</h2> <p>在应⽤module下的 AndroidManifest.xml ⽂件中声明以下权限</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">&gt;</span></span>
   <span class="token comment">&lt;!--必选权限--&gt;</span>
   <span class="token comment">&lt;!--网络通信--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.INTERNET<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token comment">&lt;!--获取网络状态--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_NETWORK_STATE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token comment">&lt;!--获取WIFI状态--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_WIFI_STATE<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

   <span class="token comment">&lt;!--以下权限是可选权限，不声明此部分权限将放弃部分设备信息的采集，对数据分析及设备指纹的精准度有一定影响--&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_COARSE_LOCATION<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_FINE_LOCATION<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.READ_PHONE_STATE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
   <span class="token comment">&lt;!-- Android11及以上获取安装包列表需要该权限，采集安装包列表涉及到⻛险合规，是否需要该权限业务⽅⾃⾏选
择 --&gt;</span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.permission.QUERY_ALL_PACKAGES<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">tools:</span>ignore</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>QueryAllPackagesPermission<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>动态申请权限： Android 6.0 及以上版本需要动态申请权限，动态申请权限代码必须放在初始化 SDK 前，代码示例如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//以下权限不是必须申请. 可根据业务情况选择性权限申请</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Build</span><span class="token punctuation">.</span><span class="token constant">VERSION</span><span class="token punctuation">.</span><span class="token constant">SDK_INT</span> <span class="token operator">&gt;=</span> <span class="token class-name">Build<span class="token punctuation">.</span>VERSION_CODES<span class="token punctuation">.</span>M</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">requestPermissions</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>
            <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token constant">ACCESS_FINE_LOCATION</span><span class="token punctuation">,</span>
            <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token constant">ACCESS_COARSE_LOCATION</span><span class="token punctuation">,</span>
            <span class="token class-name">Manifest</span><span class="token punctuation">.</span>permission<span class="token punctuation">.</span><span class="token constant">READ_PHONE_STATE</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="sdk-的使用方法"><a href="#sdk-的使用方法" class="header-anchor">#</a> <strong>SDK 的使用方法</strong></h2> <p><strong>注意事项</strong></p> <p>确保在用户同意隐私协议后，再进行SDK初始化，避免出现用户未同意隐私协议就进行SDK初始化采集，引发合规风险。</p> <p><strong>SDK配置</strong></p> <p>TD的sdk使用TDRisk.Builder方法对sdk初始参数进行配置设置，并将设置结果作为初始化参数提供给sdk初始化方法initWithOptions()使用。</p> <p><strong>TDRisk.Builder必须参数配置如下</strong></p> <table><thead><tr><th>配置 key</th> <th>定义</th> <th>说明</th> <th>示例代码</th></tr></thead> <tbody><tr><td>partner</td> <td>合作方编码</td> <td>同盾的合作方编码，请联系同盾运营获取</td> <td>builder.partnerCode(&quot;partner&quot;)</td></tr> <tr><td>appKey</td> <td>应用标识</td> <td>同盾生成的应用标识，和app绑定，用于校验app的有效性，请联系同盾运营获取 appkey创建需要用户提供应用包名、小写的sha256 签名。 ⚠️不同应用的包名签名不要使用相同的值</td> <td>builder.appKey(&quot;appKey&quot;)</td></tr> <tr><td>appName</td> <td>应用名称</td> <td>同盾平台注册的应用名称，请联系同盾运营获取</td> <td>builder.appName(&quot;appName&quot;)</td></tr> <tr><td>country</td> <td>国家地区</td> <td><strong>TDRisk.COUNTRY_US</strong> 北美 <strong>TDRisk.COUNTRY_FRA</strong> 欧洲 <strong>TDRisk.COUNTRY_SG</strong> 新加坡 <strong>TDRisk.COUNTRY_CN</strong> 中国</td> <td>builder.country(TDRisk.COUNTRY_CN)</td></tr></tbody></table> <p>我们也提供了可选参数配置，详情可以见附表（初始化配置可选参数列表）</p> <p><strong>SDK使用方法示例代码:</strong></p> <p>在应用启动的时候，比如在应用的 application 的 onCreate 方法中(Android 6.0 及以上版本应确保已经申请过权限)调用以下方法：</p> <h4 id="方式一-推荐的方式-通过getblackbox-方法获取blackbox"><a href="#方式一-推荐的方式-通过getblackbox-方法获取blackbox" class="header-anchor">#</a> 方式一(推荐的方式): <strong>通过</strong>getBlackBox() 方法获取blackbox</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// SDK初始化配置</span>
<span class="token class-name">TDRisk<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TDRisk<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/*************************** 必传 ***************************/</span>
<span class="token punctuation">.</span><span class="token function">partnerCode</span><span class="token punctuation">(</span><span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>        <span class="token comment">// 同盾的合作⽅编码，如demo，请填写⾃身的合作⽅编码</span>
<span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token string">&quot;appName&quot;</span><span class="token punctuation">)</span>         <span class="token comment">// 同盾平台注册的应⽤名称，请联系同盾运营获取</span>
<span class="token punctuation">.</span><span class="token function">appKey</span><span class="token punctuation">(</span><span class="token string">&quot;appKey&quot;</span><span class="token punctuation">)</span>           <span class="token comment">// 配置AppKey，请联系同盾运营获取		 </span>
<span class="token punctuation">.</span><span class="token function">country</span><span class="token punctuation">(</span><span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token constant">COUNTRY_CN</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 国家地区参数，如cn、sg、us、fra</span>
<span class="token comment">/*************************** 必传 ***************************/</span>

<span class="token comment">// 初始化态势感知SDK</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>⽤户同意隐私协议<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token function">initWithOptions</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>⚠️注意事项：必须保证 <code>initWithOptions</code>后 调用 <code>getBlackBox</code> 。</p> <p>在业务需要的时候获取blackbox。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> blackbox <span class="token operator">=</span> <span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token function">getBlackBox</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="方式二-通过回调方法callback-在onevent中获取blackbox"><a href="#方式二-通过回调方法callback-在onevent中获取blackbox" class="header-anchor">#</a> 方式二: 通过回调方法callback，在onEvent中获取blackbox</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// SDK初始化配置</span>
<span class="token class-name">TDRisk<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TDRisk<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">/*************************** 必传 ***************************/</span>
<span class="token punctuation">.</span><span class="token function">partnerCode</span><span class="token punctuation">(</span><span class="token string">&quot;demo&quot;</span><span class="token punctuation">)</span>        <span class="token comment">// 同盾的合作⽅编码，如demo，请填写⾃身的合作⽅编码</span>
<span class="token punctuation">.</span><span class="token function">appName</span><span class="token punctuation">(</span><span class="token string">&quot;appName&quot;</span><span class="token punctuation">)</span>         <span class="token comment">// 同盾平台注册的应⽤名称，请联系同盾运营获取</span>
<span class="token punctuation">.</span><span class="token function">appKey</span><span class="token punctuation">(</span><span class="token string">&quot;appKey&quot;</span><span class="token punctuation">)</span>           <span class="token comment">// 配置AppKey，请联系同盾运营获取		 </span>
<span class="token punctuation">.</span><span class="token function">country</span><span class="token punctuation">(</span><span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token constant">COUNTRY_CN</span><span class="token punctuation">)</span> <span class="token comment">// 国家地区参数，如cn、sg、us、fra</span>
<span class="token comment">/*************************** 必传 ***************************/</span>

<span class="token comment">// 回调结果</span>
<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TDRiskCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onEvent</span><span class="token punctuation">(</span><span class="token class-name">String</span> blackbox<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 此处回调在⼦线程</span>
    <span class="token comment">// ⽹络正常的情况下，会在200-300ms内返回结果。</span>
    <span class="token comment">// ⽹络异常的情况下，会在超时时间（默认最长15s）后返回。</span>
    <span class="token comment">// 请在下⽅添加您对blackbox的处理逻辑</span>
    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;TDRiskDemo&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;blackbox: &quot;</span> <span class="token operator">+</span> blackbox<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 初始化态势感知SDK</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>⽤户同意隐私协议<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token function">initWithOptions</span><span class="token punctuation">(</span><span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> builder<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="两种方式的差异"><a href="#两种方式的差异" class="header-anchor">#</a> 两种方式的差异</h4> <ul><li>方式一是同步获取blackbox，优点是可以保证会获取到blackbox（一些情况下为降级blackbox），如果在主线程调用 getBlackBox需要注意耗时问题。</li> <li>方式二是异步获取blackbox，优点是不会阻塞进程，无耗时问题，缺点是调用getBlackBox方式时初始化尚未完成，无法获得blackbox。需要注意 回调结果不是在主线程，禁止在回调中操作UI。</li></ul> <p>SDK上报数据成功后，正常情况下，getBlackbox()返回的结果长度为26位字符串. 如: <code>rWPGX1678775227I9NCwcuVJCb</code>。
异常情况下，长度为5000字符左右. 详情可查看<a href="https://doc.trustdecision.com/API?article=36922&amp;version=152" target="_blank" rel="noopener noreferrer">总览<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>执行initWithOptions初始化成功会在 logcat中打印以下log：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token constant">TD_JAVA</span><span class="token operator">:</span> <span class="token class-name">Tongdun</span> sdk load success
<span class="token constant">TD_JAVA</span><span class="token operator">:</span> <span class="token class-name">Tongdun</span> sdk init success
</code></pre></div><h2 id="获取sdk版本号"><a href="#获取sdk版本号" class="header-anchor">#</a> 获取SDK版本号</h2> <p><strong>示例代码</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 获取SDK版本号</span>
<span class="token class-name">TDRisk</span><span class="token punctuation">.</span><span class="token function">getSDKVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="其他说明"><a href="#其他说明" class="header-anchor">#</a> 其他说明</h2> <p>混淆打包 如果开发者需要使用 proguard 进行混淆打包，请在 proguard 配置文件添加如下代码：</p> <div class="language-java extra-class"><pre class="language-java"><code>#<span class="token constant">TONGDUN</span>
<span class="token operator">-</span>keep <span class="token keyword">class</span> cn<span class="token punctuation">.</span>tongdun<span class="token punctuation">.</span>*<span class="token operator">*</span><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
</code></pre></div><hr> <h2 id="初始化配置可选参数列表"><a href="#初始化配置可选参数列表" class="header-anchor">#</a> 初始化配置可选参数列表</h2> <table><thead><tr><th>配置 key</th> <th>定义</th> <th>说明</th> <th>示例代码</th></tr></thead> <tbody><tr><td>setHttpTimeout</td> <td>SDK超时时间配置（单位:毫秒）</td> <td>SDK初始化采集上报后，网络请求回调的超时时间，SDK默认为15 * 1000ms</td> <td>builder.httpTimeout(5000)</td></tr> <tr><td>callback</td> <td>SDK异步回调配置</td> <td>SDK初始化采集上报后，根据网络请求结果返回blackbox。请求成功：返回非降级blackbox 请求失败：返回降级blackbox</td> <td>builder.callback()</td></tr> <tr><td>collectLevel</td> <td>降级blackbox采集字段长度配置</td> <td>降级的blackbox会较长。通过此配置可控制降级的blackbox长度 1.TDRisk.COLLECT_LEVEL_L(默认值, 降级长度为5000字符左右) 2.TDRisk.COLLECT_LEVEL_M(降级长度为2000字符左右)</td> <td>builder.collectLevel(TDRisk.COLLECT_LEVEL_L)</td></tr> <tr><td>blackBoxMaxSize</td> <td>blackbox 最大长度</td> <td>默认长度为 Integer.MAX_VALUE, 根据实际设备情况会有上浮</td> <td>builder.blackBoxMaxSize(3000)</td></tr> <tr><td>customProcessName</td> <td>自定义进程名</td> <td>更改进程的名称</td> <td>builder.customProcessName(&quot;td&quot;)</td></tr> <tr><td>forceTLSVersion</td> <td>https是否强制使用TLS-v1.1版本</td> <td>默认不强制，开发者根据具体情况进行对应设置</td> <td>builder.forceTLSVersion(true)</td></tr> <tr><td>disableDebugger</td> <td>是否允许调试</td> <td>集成SDK后App默认允许调试，开发者根据具体情况进行对应设置</td> <td>builder.disableDebugger()</td></tr> <tr><td>disableRunningTasks</td> <td>是否允许获取正在运行的任务</td> <td>默认采集运行任务, 可以调用此方法进行关闭</td> <td>builder.disableRunningTasks()</td></tr> <tr><td>disableGPS</td> <td>不采集GPS相关信息</td> <td>如果需要不采集定位相关信息，可通过该方法取消定位相关信息的采集。配置该选项后，应用拥有定位权限，SDK也不会去采集定位相关信息。</td> <td>builder.disableGPS()</td></tr> <tr><td>disableSensor</td> <td>不采集传感器信息</td> <td>如果需要不采集传感器相关信息，可通过该方法取消采集相关信息</td> <td>builder.disableSensor()</td></tr> <tr><td>disableReadPhone</td> <td>不采集READ_PHONE_STATE相关信息</td> <td>默认采集需要READ_PHONE_STATE权限的信息, 可以调用此方法进行关闭</td> <td>builder.disableReadPhone()</td></tr> <tr><td>disableInstallPackageList</td> <td>不采集安装包列表</td> <td>默认采集安装包列表, 可以调用此方法进行关闭</td> <td>builder.disableInstallPackageList()</td></tr></tbody></table> <h1 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h1> <p><strong>Q1</strong>：为什么获取的 blackbox 字段比较长？</p> <p><strong>A1</strong>：正常情况下 blackbox 长度为 26字节，但是由于网络情况较差或者函数 TDRisk.initWithOptions()和 TDRisk.getBlackBox()调用间隔时间较短时，blackbox 会附带一些设备信息长度将增大到 1500-3000 字节。</p> <p><strong>Q2</strong>：为什么事件中部分信息为空？</p> <p><strong>A2</strong>：可能由于从 SDK 初始化到获取设备数据间隔时间过短，造成设备信息获取失败。切勿初始化之后立即获取设备信息。</p> <p><strong>Q3</strong>：为何部分事件的真实 IP 是空的？</p> <p><strong>A3</strong>：当 SDK 上传设备信息失败(超时或者网络被屏蔽)时，将自动转为离线模式，此种情况下同盾无法获取真实 IP。</p> <p><strong>Q4</strong>：为何在某些架构的手机上 app 会崩溃？</p> <p><strong>A4</strong>：SDK 支持多种架构，如果 app 因此崩溃，可能是对应架构的 so 目录没有导入对应的 so 文件,请注意你的 ndk 支持的架构。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">:</span> <span class="time">2023/06/07 16:19:48</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/td/zh/doc/" class="prev router-link-active">
        总览
      </a></span> <span class="next"><a href="/td/zh/doc/fingerprint/ios.html">
        iOS
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/td/assets/js/app.d5f99f5a.js" defer></script><script src="/td/assets/js/2.2e3d5896.js" defer></script><script src="/td/assets/js/54.4536f93c.js" defer></script>
  </body>
</html>
