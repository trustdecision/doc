<!DOCTYPE html>
<html lang="English">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Client-side integration | trustdevice</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/td/logo/icon.png">
    <script>
            var _hmt = _hmt || [];
            (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?4430f3f32f20bc88a8d30fe02df17081";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s); })();
            </script>
    <meta name="description" content="">
    <meta name="google-site-verification" content="NSp25_zH--p8r461f1YcEUt0LX9s7oRnyP3iBTvANIQ">
    <meta name="baidu-site-verification" content="codeva-A2SMJcZcws">
    
    <link rel="preload" href="/td/assets/css/0.styles.a099e45a.css" as="style"><link rel="preload" href="/td/assets/js/app.185a84cc.js" as="script"><link rel="preload" href="/td/assets/js/2.2e3d5896.js" as="script"><link rel="preload" href="/td/assets/js/27.c528b1c4.js" as="script"><link rel="prefetch" href="/td/assets/js/10.d1a0450d.js"><link rel="prefetch" href="/td/assets/js/11.20c64dab.js"><link rel="prefetch" href="/td/assets/js/12.3d8ad0f6.js"><link rel="prefetch" href="/td/assets/js/13.97bdc425.js"><link rel="prefetch" href="/td/assets/js/14.ffcd274e.js"><link rel="prefetch" href="/td/assets/js/15.276ed812.js"><link rel="prefetch" href="/td/assets/js/16.e2de7c8c.js"><link rel="prefetch" href="/td/assets/js/17.77d1d906.js"><link rel="prefetch" href="/td/assets/js/18.b7c44b45.js"><link rel="prefetch" href="/td/assets/js/19.f3fdc9fc.js"><link rel="prefetch" href="/td/assets/js/20.4ce2f16d.js"><link rel="prefetch" href="/td/assets/js/21.9106a342.js"><link rel="prefetch" href="/td/assets/js/22.8de5b04e.js"><link rel="prefetch" href="/td/assets/js/23.75f67d14.js"><link rel="prefetch" href="/td/assets/js/24.7c417886.js"><link rel="prefetch" href="/td/assets/js/25.7ced5130.js"><link rel="prefetch" href="/td/assets/js/26.4e29552d.js"><link rel="prefetch" href="/td/assets/js/28.1858c5da.js"><link rel="prefetch" href="/td/assets/js/29.bf9bfb41.js"><link rel="prefetch" href="/td/assets/js/3.2158ca86.js"><link rel="prefetch" href="/td/assets/js/30.e127d219.js"><link rel="prefetch" href="/td/assets/js/31.af9c2105.js"><link rel="prefetch" href="/td/assets/js/32.b89c8ceb.js"><link rel="prefetch" href="/td/assets/js/33.110a9675.js"><link rel="prefetch" href="/td/assets/js/34.2ef87457.js"><link rel="prefetch" href="/td/assets/js/35.35d7147e.js"><link rel="prefetch" href="/td/assets/js/36.4f7e50ed.js"><link rel="prefetch" href="/td/assets/js/37.65bebbe2.js"><link rel="prefetch" href="/td/assets/js/38.a12717c4.js"><link rel="prefetch" href="/td/assets/js/39.4d2a5484.js"><link rel="prefetch" href="/td/assets/js/4.2885e313.js"><link rel="prefetch" href="/td/assets/js/40.e61eb3cb.js"><link rel="prefetch" href="/td/assets/js/41.b36c9bc6.js"><link rel="prefetch" href="/td/assets/js/42.6923d430.js"><link rel="prefetch" href="/td/assets/js/43.c0676a63.js"><link rel="prefetch" href="/td/assets/js/44.a4deda5e.js"><link rel="prefetch" href="/td/assets/js/45.f7fa5a91.js"><link rel="prefetch" href="/td/assets/js/46.eb23c720.js"><link rel="prefetch" href="/td/assets/js/47.21918068.js"><link rel="prefetch" href="/td/assets/js/48.6944f99d.js"><link rel="prefetch" href="/td/assets/js/49.0e78f848.js"><link rel="prefetch" href="/td/assets/js/5.102392b0.js"><link rel="prefetch" href="/td/assets/js/50.923f3a0a.js"><link rel="prefetch" href="/td/assets/js/51.502adbfd.js"><link rel="prefetch" href="/td/assets/js/52.39a8f530.js"><link rel="prefetch" href="/td/assets/js/53.86260b02.js"><link rel="prefetch" href="/td/assets/js/54.4536f93c.js"><link rel="prefetch" href="/td/assets/js/55.0dc4fe6a.js"><link rel="prefetch" href="/td/assets/js/56.f97e27e3.js"><link rel="prefetch" href="/td/assets/js/57.8476743f.js"><link rel="prefetch" href="/td/assets/js/58.93c9de17.js"><link rel="prefetch" href="/td/assets/js/59.0bea9c2e.js"><link rel="prefetch" href="/td/assets/js/6.ea70f831.js"><link rel="prefetch" href="/td/assets/js/7.3611bbe9.js"><link rel="prefetch" href="/td/assets/js/8.8fde20e2.js"><link rel="prefetch" href="/td/assets/js/9.29164caf.js">
    <link rel="stylesheet" href="/td/assets/css/0.styles.a099e45a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/td/" class="home-link router-link-active"><img src="/td/logo/icon.png" alt="trustdevice" class="logo"> <span class="site-name can-hide">trustdevice</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/td/doc/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/td/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/captcha/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/captcha/js.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/td/doc/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="/td/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/td/doc/captcha/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/td/zh/doc/captcha/js.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/trustdecision" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/doc/" aria-current="page" class="sidebar-link">Overview</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Fingerprint</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/doc/fingerprint/android.html" class="sidebar-link">Android</a></li><li><a href="/td/doc/fingerprint/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/doc/fingerprint/js.html" class="sidebar-link">Web</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Captcha</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/td/doc/captcha/android.html" class="sidebar-link">Android</a></li><li><a href="/td/doc/captcha/ios.html" class="sidebar-link">iOS</a></li><li><a href="/td/doc/captcha/js.html" aria-current="page" class="active sidebar-link">Web</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/td/doc/captcha/js.html#client-side-integration" class="sidebar-link">Client-side integration</a></li><li class="sidebar-sub-header"><a href="/td/doc/captcha/js.html#configurations" class="sidebar-link">Configurations</a></li><li class="sidebar-sub-header"><a href="/td/doc/captcha/js.html#methods" class="sidebar-link">Methods</a></li></ul></li><li><a href="/td/doc/captcha/weChat.html" class="sidebar-link">WeChat</a></li><li><a href="/td/doc/captcha/alipay.html" class="sidebar-link">Alipay</a></li><li><a href="/td/doc/captcha/byteDance.html" class="sidebar-link">ByteDance</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="client-side-integration"><a href="#client-side-integration" class="header-anchor">#</a> Client-side integration</h2> <p>Insert the javascript below to the head tag of your key page, such as Sign-in, Sign-up, Find-password, and other pages that require a captcha challenge:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     _fmOpt <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">partner</span><span class="token operator">:</span> <span class="token string">'pc_xxx'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">appName</span><span class="token operator">:</span> <span class="token string">'an_xxx'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">display</span><span class="token operator">:</span> <span class="token string">'bind'</span><span class="token punctuation">,</span> <span class="token comment">// bind type</span>
        <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#captcha'</span><span class="token punctuation">,</span> <span class="token comment">// target dom for the trigger button</span>
        <span class="token literal-property property">initialTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> fm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    fm<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>
    fm<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'Base URL'</span> <span class="token operator">+</span> <span class="token string">'?t='</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">600000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>fm<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Base URL</strong></p> <table><thead><tr><th>Region</th> <th>Base URL</th></tr></thead> <tbody><tr><td>China</td> <td>https://static.tongdun.net/captcha/main/tdc.js</td></tr> <tr><td>North America</td> <td>https://static.tongdun.net/us/captcha/main/tdc.js</td></tr> <tr><td>Singapore</td> <td>https://static.tongdun.net/sg/captcha/main/tdc.js</td></tr> <tr><td>Germany</td> <td>https://static.tongdun.net/fra/captcha/main/tdc.js</td></tr></tbody></table> <p><strong>Note:</strong> If you have embedded the fingerprint of TD, please remove the relevant code first.</p> <h2 id="configurations"><a href="#configurations" class="header-anchor">#</a> Configurations</h2> <p>You can make your configuration by the <strong>_fmOpt</strong> object of the integration above. The common configuration of the parameters have been given in the sample code, but you can also make further configuration following the parameter descriptions below.</p> <h3 id="action-mode"><a href="#action-mode" class="header-anchor">#</a> Action Mode</h3> <table><thead><tr><th>Action mode</th> <th>Description</th></tr></thead> <tbody><tr><td>bind type</td> <td>the trigger event will be bound to the button dom that you specified, such as sign-in, sign-up, and other buttons.</td></tr> <tr><td>trigger type</td> <td>there will render a button named <code>Click to verify</code> automatically</td></tr></tbody></table> <h3 id="parameters-list"><a href="#parameters-list" class="header-anchor">#</a> Parameters List</h3> <table><thead><tr><th><strong>Parameter</strong></th> <th>Type</th> <th>Required</th> <th>Description</th></tr></thead> <tbody><tr><td>partner</td> <td>String</td> <td>Yes</td> <td>partner code, assigned by TD</td></tr> <tr><td>appName</td> <td>String</td> <td>Yes</td> <td>application id, assigned by TD</td></tr> <tr><td>display</td> <td>String</td> <td>Yes</td> <td>display mode, optional value: popup/float/custom/bind. detail explanation: <strong>popup</strong>: the captcha dialog will be displayed in the middle of the screen and filled with a mask outside it. Users can close the captcha dialog by clicking the mask. <strong>float</strong>: the captcha dialog will be rendered above the specified button. <strong>custom</strong>: the captcha dialog will be rendered in the <strong>area</strong> dom that you specified. <strong>bind</strong>: the captcha dialog will be displayed in the middle of the screen also, corresponding to the bind action mode.</td></tr> <tr><td>container</td> <td>String</td> <td>Yes</td> <td>dom selector. For bind action mode, it is used to specify the dom of the button which will trigger the captcha event. For trigger action mode, it is used to specify the dom where the button will render automatically.</td></tr> <tr><td>area</td> <td>String</td> <td>No</td> <td>dom selector. Only for custom display mode. It is used to specify where the captcha dialog will render.</td></tr> <tr><td>width</td> <td>String</td> <td>No</td> <td>the width of the button that is rendered automatically for the trigger action mode. Default: 300px, min: 200px</td></tr> <tr><td>height</td> <td>String</td> <td>No</td> <td>the height of the button that is rendered automatically for the trigger action mode. Default: 40px, min: 30px</td></tr> <tr><td>lang</td> <td>String</td> <td>No</td> <td>Language configuration, optional value:<strong>zh-cn</strong>(Chinese simplified),<strong>zh-han</strong>(Chinese Traditional),<strong>en</strong>(English), <strong>ja</strong>(Japanese),<strong>ko</strong>(Korean), <strong>ba</strong>(Malay), <strong>tha</strong>(Thai), <strong>idn</strong>(Indonesian), <strong>rus</strong>(Russian). Default: <strong>zh-cn</strong>(Chinese simplified)</td></tr> <tr><td>bindSucNoFed</td> <td>Boolean</td> <td>No</td> <td>Only for bind display mode. If false, it will give a successful <code>toast</code> after verifying successfully. if true, no <code>toast</code> will show. Default: false.</td></tr> <tr><td>env</td> <td>Number</td> <td>No</td> <td><strong>0</strong>: test environment, <strong>1</strong>: production environment. Default: <strong>1</strong></td></tr> <tr><td>closeIcon</td> <td>Number</td> <td>No</td> <td><strong>0</strong>: show close icon, <strong>1</strong>: hide close icon. Default: <strong>0</strong></td></tr> <tr><td>closeMask</td> <td>Number</td> <td>No</td> <td>when the user triggers a click event on the mask outside the captcha dialog, <strong>0</strong>: hide the captcha dialog, <strong>1</strong>: cannot hide the captcha dialog. Default: <strong>0</strong></td></tr> <tr><td>mfaId</td> <td>String</td> <td>No</td> <td>If you have connected to the MFA product (the parameter can be ignored if the MFA is not connected), please set the <code>mfa_id</code> which is obtained from the MFA process to the configuration parameter <code>_fmOpt</code>. Example: _fmOpt.mfaId = res.data.mfa_id;</td></tr></tbody></table> <h2 id="methods"><a href="#methods" class="header-anchor">#</a> Methods</h2> <p><strong>The following callback methods can be defined on the _fmOpt object as needed:</strong></p> <ul><li><strong>beforeValidate:</strong> if you have defined this method, it will be invoked before triggering the captcha. If the method returns <strong>true</strong>, the captcha logic will continue. <strong>false</strong> the captcha logic will stop. For example:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// The following code makes a simple judgment: when the username input box or password input box gets null values, it will be returned false, and the captcha logic will not be triggered in this case.</span>
_fmOpt<span class="token punctuation">.</span><span class="token function-variable function">beforeValidate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">||</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'username or password error.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>onReady:</strong> the captcha logic is ready at this time. If you have a <strong>loading</strong> before triggering the captcha event, you can remove it at this point.</li> <li><strong>onClose:</strong> It will be invoked after the captcha dialog is closed.</li> <li><strong>onSuccess(validateToken):</strong> It will be invoked after the verification succeed. For example:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>_fmOpt<span class="token punctuation">.</span><span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">validateToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// demo, an ajax request</span>
    <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">account</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">token</span><span class="token operator">:</span> validateToken<span class="token punctuation">,</span> <span class="token comment">// after verifying successfully, you need to invoke the API interface on your backend service to recheck the verification.</span>
        <span class="token literal-property property">blackBox</span><span class="token operator">:</span> _fmOpt<span class="token punctuation">.</span>getinfo <span class="token operator">?</span> _fmOpt<span class="token punctuation">.</span><span class="token function">getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// get the blackbox</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>onFail(msg):</strong> It will be invoked after the verification failed, callback parameters description：</li></ul> <table><thead><tr><th>msg(String)</th> <th>description</th></tr></thead> <tbody><tr><td>opFail</td> <td>verification failed</td></tr> <tr><td>op2much</td> <td>verification too much</td></tr> <tr><td>noNetwork</td> <td>timeout or no network</td></tr> <tr><td>limit</td> <td>request limit （503）</td></tr></tbody></table> <p><strong>The following methods can be invoked as needed:</strong></p> <ul><li><strong>triggerCaptcha:</strong> If you want to trigger the captcha to challenge by yourself:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>_fmOpt<span class="token punctuation">.</span><span class="token function">triggerCaptcha</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// It is used to trigger captcha initiatively</span>
</code></pre></div><ul><li><strong>reset</strong>： reset the captcha to the initial state. This usually occurs when the user has passed the verification of the captcha, but the username or password is incorrect. In this case, you need to trigger the captcha again. For example:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// demo, ajax request</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'***'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">token</span><span class="token operator">:</span> validateToken<span class="token punctuation">,</span>
    <span class="token literal-property property">blackBox</span><span class="token operator">:</span> _fmOpt<span class="token punctuation">.</span>getinfo <span class="token operator">?</span> _fmOpt<span class="token punctuation">.</span><span class="token function">getinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// get the blackbox</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">success</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token comment">// service checked failed</span>
        <span class="token comment">// reset the captcha, the user needs to trigger the captcha again</span>
        _fmOpt<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>newCaptcha:</strong> When a page needs to display multiple captchas, you can call this method to initialize a new captcha object. At this time, you need to pass in the specific parameters of the new verification. For example:</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> secondCaptchaObj <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">display</span><span class="token operator">:</span> <span class="token string">'popup'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">container</span><span class="token operator">:</span> <span class="token string">'#area'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> secondCaptcha <span class="token operator">=</span> _fmOpt<span class="token punctuation">.</span><span class="token function">newCaptcha</span><span class="token punctuation">(</span>secondCaptchaObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
secondCaptcha<span class="token punctuation">.</span><span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">validateToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'second captcha verification succeed: '</span> <span class="token operator">+</span> validateToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// todo</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="faq"><a href="#faq" class="header-anchor">#</a> FAQ</h3> <p>Q: CSS style problem (such as a captcha image broken, layout disordered...)?</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/** If the global style is set with important, the priority level is higher than the captcha style, which will cause the style to be overwritten. For example(not recommended) **/</span>
<span class="token selector">img</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span><span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Q: For the <strong>bind</strong> display mode, no response with clicking the trigger button?</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token number">1</span>. Please confirm whether the JS-SDK of TD Captcha has loaded correctly.
<span class="token number">2</span>. Please confirm Whether the bound button element exists when the JS-SDK is initialized. If the element is not rendered<span class="token punctuation">,</span> the trigger event will not be bound to the button.
</code></pre></div><p>Q: The callback method was not invoked after verifying succeed or failed？</p> <div class="language-json extra-class"><pre class="language-json"><code>onSuccess<span class="token punctuation">,</span> onFail<span class="token punctuation">,</span> and other callback methods need to be bound to the _fmOpt object when the JS-SDK is initialized<span class="token punctuation">,</span> otherwise<span class="token punctuation">,</span> the callback method cannot be found and cannot be triggered
</code></pre></div><p>Q: The callback method is not invoked for the captcha object created by the <strong>_fmOpt.newCaptcha</strong> method ?</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> secondCaptcha <span class="token operator">=</span> _fmOpt<span class="token punctuation">.</span><span class="token function">newCaptcha</span><span class="token punctuation">(</span>secondCaptchaObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
secondCaptcha<span class="token punctuation">.</span><span class="token function-variable function">onSuccess</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">validateToken</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
<span class="token comment">// the callback methods should be bound to the new secondCaptcha, and cannot be bound to _fmOpt object</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">:</span> <span class="time">2023/06/07 16:19:48</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/td/doc/captcha/ios.html" class="prev">
        iOS
      </a></span> <span class="next"><a href="/td/doc/captcha/weChat.html">
        WeChat
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/td/assets/js/app.185a84cc.js" defer></script><script src="/td/assets/js/2.2e3d5896.js" defer></script><script src="/td/assets/js/27.c528b1c4.js" defer></script>
  </body>
</html>
